<!DOCTYPE html>
<html ng-app="invoiceApp">
<head>
    <title>Adding new elements</title>

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css">    
    <link rel="stylesheet" type="text/css" href="/css/app.css">    
</head>
<body style="padding:10px">
    <div class="row" ng-controller="defaultCtrl">

        <div class="col-sm-7">
            <div class="well">
                <h3>New Invoice</h3>
                <div class="form-group row">
                    <label for="invoiceCustomer">Select customer:</label>
                <select id="invoiceCustomer"
                        class="form-control"
                        ng-model="selectedCustomer"
                        ng-options="customer.name for customer in customers track by customer.id"
                        ng-change="changeInput('customer')">
                </select>                
                </div>
                <h3>Products in Invoice</h3>
                <div class="row">
                    <div class="col-sm-5">
                        <label for="invoiceDiscount">products:</label>
                        <select id="invoiceProduct"
                                class="form-control"
                                ng-model="selectedProduct"
                                ng-options="product.name for product in products track by product.id"
                                ng-change="changeInput('product')">
                        </select>                             
                    </div>
                    <div class="col-sm-2">
                        <label>price:</label>
                        <label>{{selectedProduct.price}}</label>
                    </div>                    
                    <div class="col-sm-2">
                        <label for="invoiceQuantity">quantity:</label>
                        <input type="number" min="0"
                            id="invoiceQuantity"
                            class="form-control"
                            ng-model="invoiceItem.quantity"
                            ng-change="changeInput('quantity')"/>
                    </div>
                    <div class="col-sm-3">
                        <label for="invoiceDiscount">Add:</label>
                        <button class="btn btn-success btn-block" ng-click="addProduct2Invoice(invoiceItem)">Add Product</button>
                    </div>

                </div>                      

                <div class="row">
                    <table class="table">
                        <thead>
                            <th>name</th>
                            <th>quantity</th>
                        </thead>
                        <tbody>
                            <tr ng-repeat="invoiceItem in invoiceItems | filter : {invoice_id : invoice.id}">
                                <!--<td>{{ product.id }}</td>-->
                                <td>{{invoiceItem.id}}</td>
                                <td>{{invoiceItem.quantity}}</td>
                            </tr>
                        </tbody>
                     </table>                   
                </div>
                <div class="row">
                    <h3 class="invoice-total">invoice total = {{invoice.total}} </h3>
                </div>    
                <div class="form-group row">
                    <label for="invoiceId">id:</label>
                    <input type="number"
                        id="invoiceId"
                        class="form-control"
                        ng-model="invoice.id"
                        disabled
                        ng-change="changeInput('id')"/>
                </div>

                <div class="form-group row">
                    <label for="invoiceDiscount">discount %:</label>
                    <input type="number" min="0" max="100"
                        id="invoiceDiscount"
                        class="form-control"
                        ng-model="invoice.discount"
                        ng-change="changeInput('discount')"/>
                </div>                
                <!-- При введении значений в поля action и priority angular автоматически создает объект task и устанавливает для него свойства. -->
                <button class="btn btn-primary btn-block" ng-click="addInvoice(invoice)">Add</button>
            </div>
        </div>

        <div class="col-sm-5 panel-primary">
            <div class="panel-heading">
                <div class="panel-title">
                    <h3>
                        Invoices
                        <span class="label label-info">
                            {{(invoices | filter : {customer_id : 1 } ).length}}
                        </span>
                    </h3>
                </div>
            </div>

            <table class="table">
                <thead>
                    <th>id</th>
                    <th>customer_id</th>
                    <th>discount</th>
                    <th>total</th>
                </thead>                
                <tbody>
                    <tr ng-repeat="invoice in invoices">
                        <td>{{invoice.id}}</td>
                        <td>{{invoice.customer_id}}</td>
                        <td>{{invoice.discount}}</td>
                        <td>{{invoice.total}}</td>
                    </tr>
                </tbody>
            </table>

        </div>
    </div>

    <script type="text/javascript" src="/js/lib/jquery/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="js/lib/angularjs/angular.js"></script>
    <script type="text/javascript" src="js/app-front.js"></script>
    <script type="text/javascript" src="js/controller.js"></script>            
</body>
</html>
